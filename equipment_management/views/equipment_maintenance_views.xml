<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="view_equipment_maintenance_quick_form" model="ir.ui.view">
    <field name="name">equipment.maintenance.quick.form</field>
    <field name="model">equipment.maintenance</field>
    <field name="arch" type="xml">
      <form string="Schedule Maintenance">
        <header>
          <!-- show only when scheduled -->
          <button name="action_start" string="Start" type="object"
                  class="oe_highlight" invisible="state != 'scheduled'"/>
          <!-- show only when in progress -->
          <button name="action_complete" string="Complete" type="object"
                  invisible="state != 'in_progress'"/>
          <!-- show when scheduled or in progress -->
          <button name="action_cancel" string="Cancel" type="object"
                  invisible="state not in ('scheduled','in_progress')"/>
          <field name="state" widget="statusbar"
                 statusbar_visible="scheduled,in_progress,completed,cancelled"/>
        </header>

        <sheet>
          <group>
            <group>
              <field name="equipment_id" options="{'no_create': True}"/>
              <field name="maintenance_type"/>
              <field name="scheduled_date"/>
              <field name="technician_id" options="{'no_create': True}"/>
            </group>
            <group>
              <field name="duration"/>
              <field name="cost"/>
              <field name="currency_id" invisible="1"/>
              <field name="next_maintenance_date"/>
            </group>
          </group>

          <group string="Description">
            <field name="description" nolabel="1"
                   placeholder="Describe the maintenance to perform..."/>
          </group>

          <notebook>
            <page string="Work Done" invisible="state != 'completed'">
              <group>
                <field name="work_done"/>
                <field name="parts_used"/>
                <field name="completed_date" readonly="1"/>
              </group>
            </page>
          </notebook>
        </sheet>
      </form>
    </field>
  </record>

  <!-- (optional) list/action/menu, unchanged if you already have them -->
  <record id="view_equipment_maintenance_list" model="ir.ui.view">
    <field name="name">equipment.maintenance.list</field>
    <field name="model">equipment.maintenance</field>
    <field name="arch" type="xml">
      <list string="Maintenance">
        <field name="name"/>
        <field name="equipment_id"/>
        <field name="maintenance_type"/>
        <field name="scheduled_date"/>
        <field name="technician_id"/>
        <field name="state" widget="badge"/>
        <field name="cost"/>
      </list>
    </field>
  </record>

  <record id="action_equipment_maintenance" model="ir.actions.act_window">
    <field name="name">Maintenance</field>
    <field name="res_model">equipment.maintenance</field>
    <field name="view_mode">list,form</field>
  </record>

  <menuitem id="menu_equipment_maintenance"
            name="Maintenance"
            parent="equipment_management.menu_equipment_root"
            action="action_equipment_maintenance"
            sequence="30"/>
</odoo>
